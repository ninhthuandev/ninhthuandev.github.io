{"version":3,"sources":["pages/qr-code-tools/qr-code-generator/js/qr-code-generator.js"],"names":["QrCodeType","TEXT","URL","EMAIL","VCARD","SMS","WIFI","MimeType","urlRegex","validateForm","field","SVG","key","this","validation","rule","validationResult","error","message","mimeType","createElement","link","href","qrCodeBlobImage","download","Object","keys","find","toLowerCase","triggerDownloadImage","getElementById","Alpine","store","getBlobQrCodeForDownloading","then","blob","downloadQrCode","document","addEventListener","data","url","regex","value","test","validate","apply","subject","body","toQrCodeStringFromEmailData","email","concat","length","organization","jobTitle","phone","address","firstName","lastName","toQrCodeStringFromVCardData","website","str","replace","console","log","toQrCodeStringFromSmsData","phoneNumber","hidden","password","encryption","toQrCodeStringFromWifiData","ssid","drawer","defaultQrCodeOptions","quietZone","QRCode","CorrectLevel","M","qrCode","generateQrCode","options","text","_objectSpread","makeCode","objectUrl","createObjectURL","type","fakeElement","style","changeValueAndGenerateQrCode","changeType","isType"],"mappings":"y2CAAA,IAAMA,WAAa,CACfC,KAAM,OACNC,IAAK,MACLC,MAAO,QACPC,MAAO,QACPC,IAAK,MACLC,KAAM,QALFC,SAAQ,CACZL,IAAK,YACLC,IAAO,gBACPC,IAAO,cAGVI,SAAA,2CAUD,SAPSC,aAAWC,GAChBC,IAAK,IAAAC,KAAeC,KAAAC,WAAAJ,GAAAK,KAAA,CACf,IAAAC,EAAAH,KAAAC,WAAAJ,GAAAK,KAAAH,GAAAC,KAAAH,IACR,GAAAM,EAAAC,MAAA,CAEaJ,KAAGC,WAAAJ,GAAAO,OAAA,EAERR,KAAAA,WAAkBC,GAAEQ,QAAAF,EAAAE,QACdN,MAEHI,KAAAA,WAAgBN,GAAMO,OAAE,EACxBJ,KAAKC,WAAWJ,GAAOO,QAAY,IAS/C,SALaH,qBAAkBG,EAAaE,GACpC,IAAKL,EAAAA,SAAiBM,cAAa,KACvCC,EAAAC,KAAAC,EACJF,EAAAG,SAAA,WAAAC,OAAAC,KAAAnB,UAAAoB,KAAA,SAAAf,GAAA,OAAAL,SAAAK,KAAAO,IAAAS,cAEAP,EAASQ,QAOT,SAJSL,eAAWL,GAAiEA,SAAQW,eAAA,iBAE7FC,OAAAC,MAAA,UAAAC,4BAAAd,GAAAe,KAAA,SAAAC,GAESC,IAAejB,SAAUR,KAE9BkB,qBAD6BQ,IAASP,gBAAeK,GACrDhB,KAiBJkB,SALIC,iBAAA,cAAA,WACAP,OAAAQ,KAAA,cAAA,WAAA,MAAA,CACAC,IAAA,GACJ1B,WAAA,CAESwB,IAAAA,CACOvB,KAAA,CAAsB0B,MAAA,SAAAC,GACvB,OAAAlC,SAAAmC,KAAAD,GACK,CACHzB,OAAA,EACKC,QAAA,IAGa,CACSD,OAAA,EACHC,QAAA,8BAUzBD,OALgBC,EACJA,QAAC,KAQrB0B,SALS,SAAAlC,GACDO,aAAY4B,MAAAhC,KAAA,CAAAH,QASxBqB,OALIa,KAAQ,gBAAAA,WAAAA,MAAM,CACVnC,MAAAA,GACJqC,QAAA,GACHC,KAAA,GAAEC,4BAAA,WAEIT,MAAAA,UAAAA,OAAoB1B,KAAEoC,MAAA,aAAAC,OAAArC,KAAAiC,QAAA,UAAAI,OAAArC,KAAAkC,OACzBE,WAAS,CACTH,MAAW,CACH/B,KAAA,CACRiC,MAAAA,SAA2BN,GACvB,GAA2B,IAA3BQ,EAAiBC,OACpB,MAAA,CACWlC,OAAA,EACDC,QAAA,IAIgB,MADa,6BACbyB,KAAAD,GACS,CACHzB,OAAA,EACZC,QAAA,IAGewB,CACTzB,OAAA,EACSC,QAAA,gCAW5BD,OANqB,EAOrBC,QANuB,KAS/B0B,SANY,SAAAlC,GACHD,aAAAoC,MAAAhC,KAAA,CAAAH,QAUbqB,OANKQ,KAAA,gBAAA,WAAA,MAAA,CACDK,UAAQ,GACJnC,SAAAA,GACJ2C,aAAA,GACHC,SAAA,GAAEC,MAAA,GAEGL,MAAM,GAAiBM,QAAO,GAChCC,QAAW,GACXC,4BAAY,WACZL,IAAAA,EAAY,uDAAAF,OAEHrC,KAAA4C,SAAA,KAAAP,OAAArC,KAAA2C,UAAA,wBAAAN,OACArC,KAAA2C,UAAA,KAAAN,OAAArC,KAAA4C,SAAA,sBAAAP,OACErC,KAAAuC,aAAA,wBAAAF,OACArC,KAAAwC,SAAA,sBAAAH,OACXQ,KAAAA,MAAAA,wBAAAA,OACW7C,KAAAoC,MAAA,wBAAAC,OAQCrC,KAAK0C,QAAO,2BAAAL,OAIpBrC,KAAA8C,QAAA,2BAQDpB,OAHHqB,EAAAA,EAAAC,QAAA,OAAA,IACDC,QAAAC,IAAAH,GAESA,MAAZ7B,OAGIiC,KAAAA,cAAyB,WAAA,MAAA,CACrBC,YAAA,GACJ/C,QAAA,GACH8C,0BAAA,WAAE,MAAA,SAAAd,OAAArC,KAAAoD,YAAA,KAAAf,OAAArC,KAAAK,aAEHa,OAEImC,KAAQ,eAAK,WAAA,MAAA,CACbC,KAAQ,GACRC,QAAU,EACVC,SAAAA,GACID,WAAA,MACJC,2BAAA,WACH,MAAA,UAAAnB,OAAArC,KAAAyD,KAAA,OAAApB,OAAArC,KAAAuD,WAAA,OAAAlB,OAAArC,KAAAsD,SAAA,OAAAjB,OAAArC,KAAAqD,OAAA,OAAA,QAAA,SAIGK,IAAMC,EAAU,CAChBC,aAAWC,OAAAC,aAAAC,EACdL,OAAA,SAEKE,UAAO,IAGTI,OAAM7C,MAAM,SAAA,CAEZ8C,KAAAA,WAAc7E,KACVyC,MAAIqC,GAEAC,OAAM,KAEVF,eAAgB,WACR,IAACD,EAASI,cAAAA,cAAA,GACHT,GAAoB,GAAA,CAC5BQ,KAAAnE,KAAA6B,QAEP7B,KAAAgE,SACHhE,KAAAgE,OAAA,IAAAH,OAAArC,SAAAP,eAAA,iBAAAiD,IAKalE,KAAK6B,OAAKwC,SAAArE,KAAA6B,QAHxBT,4BAO+B,SAAAd,GAIf,IAAIgB,EAAO8C,cAAAA,cAAA,GAA2BT,GAAW7D,GAAAA,CAAKqE,KAAAnE,KAAA6B,MAElDyC,OAAAA,IAAgBC,SAAAA,IAAoB,MAAC,SAEzCvD,eAAoB,SAACsD,EAAAA,GAClB,GAAAhE,IAAAZ,SAAAI,IAAA,CACHkB,IAAAA,EAA2BV,wEAAAA,OAEnCoB,GAGcF,EAASjB,IAAAA,KAAAA,CAAAA,GAAoB,CAAAiE,KAAA9E,SAAAI,MAKlDkB,qBAF2ByD,IAAaP,gBAAQ5C,GAEhDhB,QAGqBU,qBAAAU,EAAApB,MAMrBmE,EAAAjD,SAAAjB,cAAA,OAGGkE,EAAgBC,MAAKF,MAAI,SAC7B,IAAAX,OAAAY,EAAAP,GACFG,SAAArE,KAAA6B,QAZE8C,6BAA4B,SAAC9C,GACzB7B,KAAK6B,MAAQA,EACb7B,KAAKiE,kBAGTW,WAAU,SAACJ,GACPxE,KAAKwE,KAAOA,GAGhBK,OAAM,SAACL,GACH,OAAOxE,KAAKwE,OAASA,KAI7BtD,OAAOC,MAAM,UAAU8C","file":"qr-code-generator.js","sourcesContent":["const QrCodeType = {\r\n    TEXT: 'TEXT',\r\n    URL: 'URL',\r\n    EMAIL: 'EMAIL',\r\n    VCARD: 'VCARD',\r\n    SMS: 'SMS',\r\n    WIFI: 'WIFI',\r\n}\r\n\r\nconst MimeType = {\r\n    PNG: 'image/png',\r\n    SVG: 'image/svg+xml',\r\n    JPG: 'image/jpeg',\r\n}\r\n\r\nconst urlRegex = /^(https?|chrome):\\/\\/[^\\s$.?#].[^\\s]*$/gm;\r\n\r\nfunction validateForm(field) {\r\n    for (const key in this.validation[field].rule) {\r\n        const validationResult = this.validation[field].rule[key](this[field])\r\n        if (validationResult.error) {\r\n            this.validation[field].error = true;\r\n            this.validation[field].message = validationResult.message;\r\n            break;\r\n        }\r\n        this.validation[field].error = false;\r\n        this.validation[field].message = '';\r\n    }\r\n}\r\n\r\nfunction triggerDownloadImage(qrCodeBlobImage, mimeType) {\r\n    const link = document.createElement('a');\r\n    link.href = qrCodeBlobImage;\r\n    link.download = 'qr-code.' + Object.keys(MimeType).find(key => MimeType[key] === mimeType).toLowerCase();\r\n    link.click();\r\n}\r\n\r\nfunction downloadQrCode(mimeType) {\r\n    const qrCodeImageContainer = document.getElementById('qr-code-image');\r\n    // const qrCodeCanvas = qrCodeImageContainer.querySelector('canvas');\r\n    // const qrCodeImage = qrCodeCanvas.toDataURL(mimeType);\r\n    Alpine.store('qrCode').getBlobQrCodeForDownloading(mimeType).then((blob) => {\r\n        if (mimeType !== MimeType.SVG) {\r\n            const qrCodeBlobImage = URL.createObjectURL(blob);\r\n            triggerDownloadImage(qrCodeBlobImage, mimeType);\r\n        }\r\n    });\r\n    // if (mimeType !== MimeType.SVG) {\r\n    //     triggerDownloadImage(qrCodeImage);\r\n    // } else {\r\n    //     const ctx = new C2S(500, 500);\r\n    //     ctx.fillStyle=\"white\";\r\n    //\r\n    // }\r\n}\r\n\r\ndocument.addEventListener('alpine:init', () => {\r\n    Alpine.data('urlFormData', () => ({\r\n        url: '',\r\n        validation: {\r\n            url: {\r\n                rule: {\r\n                    regex: function (value) {\r\n                        if (urlRegex.test(value)) {\r\n                            return {\r\n                                error: false,\r\n                                message: '',\r\n                            };\r\n                        } else {\r\n                            return {\r\n                                error: true,\r\n                                message: 'Please input correct URL',\r\n                            };\r\n                        }\r\n                    }\r\n                },\r\n                error: false,\r\n                message: '',\r\n            },\r\n        },\r\n        validate(field) {\r\n            validateForm.apply(this, [field]);\r\n        }\r\n    }));\r\n\r\n    Alpine.data('emailFormData', () => ({\r\n        email: '',\r\n        subject: '',\r\n        body: '',\r\n        toQrCodeStringFromEmailData() {\r\n            return `mailto:${this.email}?subject=${this.subject}&body=${this.body}`;\r\n        },\r\n        validation: {\r\n            email: {\r\n                rule: {\r\n                    regex: function (value) {\r\n                        if (value.length === 0) {\r\n                            return {\r\n                                error: false,\r\n                                message: '',\r\n                            };\r\n                        }\r\n                        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n                        if (emailRegex.test(value)) {\r\n                            return {\r\n                                error: false,\r\n                                message: '',\r\n                            };\r\n                        } else {\r\n                            return {\r\n                                error: true,\r\n                                message: 'Please input correct email',\r\n                            };\r\n                        }\r\n                    }\r\n                },\r\n                error: false,\r\n                message: '',\r\n            },\r\n        },\r\n        validate(field) {\r\n            validateForm.apply(this, [field]);\r\n        }\r\n    }));\r\n\r\n    Alpine.data('vCardFormData', () => ({\r\n        firstName: '',\r\n        lastName: '',\r\n        organization: '',\r\n        jobTitle: '',\r\n        phone: '',\r\n        email: '',\r\n        address: '',\r\n        website: '',\r\n        toQrCodeStringFromVCardData() {\r\n            let str = `BEGIN:VCARD\r\n            VERSION:3.0\r\n            N:${this.lastName};${this.firstName};;;\r\n            FN:${this.firstName} ${this.lastName}\r\n            ORG:${this.organization}\r\n            TITLE:${this.jobTitle}\r\n            TEL:${this.phone}\r\n            EMAIL:${this.email}\r\n            ADR:;;${this.address};;;;;\r\n            URL:${this.website}\r\n            END:VCARD`;\r\n\r\n            // remove indentations\r\n            str = str.replace(/  +/g, '');\r\n\r\n            console.log(str);\r\n            return str;\r\n        }\r\n    }));\r\n\r\n    Alpine.data('smsFormData', () => ({\r\n        phoneNumber: '',\r\n        message: '',\r\n        toQrCodeStringFromSmsData() {\r\n            return `SMSTO:${this.phoneNumber}:${this.message}`;\r\n        }\r\n    }));\r\n\r\n    Alpine.data('wifiFormData', () => ({\r\n        ssid: '',\r\n        hidden: false,\r\n        password: '',\r\n        encryption: 'WPA',\r\n        toQrCodeStringFromWifiData() {\r\n            return `WIFI:S:${this.ssid};T:${this.encryption};P:${this.password};H:${this.hidden ? 'true' : 'false'};`;\r\n        }\r\n    }));\r\n\r\n    const defaultQrCodeOptions = {\r\n        correctLevel: QRCode.CorrectLevel.M,\r\n        drawer: 'canvas',\r\n        quietZone: 20,\r\n    }\r\n\r\n    Alpine.store('qrCode', {\r\n        type: QrCodeType.TEXT,\r\n        value: '',\r\n        qrCode: null,\r\n\r\n        generateQrCode() {\r\n            let options = {\r\n                ...defaultQrCodeOptions,\r\n                text: this.value,\r\n            };\r\n            if (!this.qrCode) {\r\n                this.qrCode = new QRCode(document.getElementById('qr-code-image'), options);\r\n                this.qrCode.makeCode(this.value);\r\n            } else {\r\n                this.qrCode.makeCode(this.value);\r\n            }\r\n        },\r\n\r\n        getBlobQrCodeForDownloading(mimeType) {\r\n            let options = {\r\n                ...defaultQrCodeOptions,\r\n                text: this.value,\r\n                drawer: mimeType === MimeType.SVG ? 'svg' : 'canvas',\r\n                onRenderingEnd: (_, data) => {\r\n                    if (mimeType === MimeType.SVG) {\r\n                        const svgString =\r\n                        `<?xml version=\"1.0\" encoding=\"iso-8859-1\"?>\r\n                        ${data}`\r\n\r\n                        let blob = new Blob([svgString], {type: MimeType.SVG});\r\n\r\n                        let objectUrl = URL.createObjectURL(blob);\r\n\r\n                        triggerDownloadImage(objectUrl, mimeType);\r\n                    } else {\r\n                        triggerDownloadImage(data, mimeType);\r\n                    }\r\n                }\r\n            };\r\n\r\n            let fakeElement = document.createElement('div');\r\n\r\n            fakeElement.style.width = '1000px';\r\n            let qrCode = new QRCode(fakeElement, options);\r\n            qrCode.makeCode(this.value);\r\n        },\r\n\r\n        changeValueAndGenerateQrCode(value) {\r\n            this.value = value;\r\n            this.generateQrCode();\r\n        },\r\n\r\n        changeType(type) {\r\n            this.type = type;\r\n        },\r\n\r\n        isType(type) {\r\n            return this.type === type;\r\n        }\r\n    });\r\n\r\n    Alpine.store('qrCode').generateQrCode();\r\n})\r\n;\r\n"]}